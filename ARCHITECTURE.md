# ğŸ—ï¸ Promptä¼˜åŒ–å™¨ç³»ç»Ÿæ¶æ„

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

Promptä¼˜åŒ–å™¨æ˜¯ä¸€ä¸ªåŸºäºå¤šAgentåä½œçš„æ™ºèƒ½ç³»ç»Ÿï¼Œä½¿ç”¨LangGraphå®ç°å·¥ä½œæµç¼–æ’ï¼Œæ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„èŒè´£å’Œæ¥å£ã€‚

## ğŸ¯ æ ¸å¿ƒç»„ä»¶

### 1. è¯·æ±‚å¤„ç†å±‚ (Request Layer)
- **PromptRequest**: è¯·æ±‚æ•°æ®ç»“æ„
  - `role`: ç›®æ ‡ç”¨æˆ·è§’è‰²
  - `basic_requirements`: åŸºæœ¬ä»»åŠ¡è¦æ±‚
  - `examples`: å¯é€‰çš„ç¤ºä¾‹é›†åˆ
  - `additional_requirements`: å¯é€‰çš„é¢å¤–è¦æ±‚
  - `model_type`: ä½¿ç”¨çš„æ¨¡å‹ç±»å‹

### 2. Agentå±‚ (Agent Layer)
- **PromptGeneratorAgent**: ç”Ÿæˆåˆå§‹promptå’Œå·¥ç¨‹æŒ‡å¯¼
- **PromptEvaluatorAgent**: è¯„ä¼°promptè´¨é‡å’Œç”Ÿæˆè¯„ä¼°æ¡†æ¶
- **PromptImproverAgent**: ç”Ÿæˆæ”¹è¿›æ–¹æ¡ˆå’Œä¼˜åŒ–å»ºè®®

### 3. å·¥ä½œæµå±‚ (Workflow Layer)
- **PromptOptimizerWorkflow**: åè°ƒå¤šä¸ªAgentçš„å·¥ä½œæµç¨‹
  1. ç”Ÿæˆå·¥ç¨‹æŒ‡å¯¼
  2. åˆ†æè§’è‰²å’Œè¦æ±‚
  3. ç”Ÿæˆåˆå§‹prompt
  4. åˆ›å»ºè¯„ä¼°æ¡†æ¶
  5. æ‰§è¡Œpromptè¯„ä¼°
  6. ç”Ÿæˆæ”¹è¿›æ–¹æ¡ˆ
  7. é€‰æ‹©æœ€ä½³ç‰ˆæœ¬

### 4. æ¨¡å‹å±‚ (Model Layer)
- **ModelFactory**: æ¨¡å‹å·¥å‚ç±»
  - æ”¯æŒå¤šç§æ¨¡å‹ç±»å‹
  - å¤„ç†æ¨¡å‹å®ä¾‹ç¼“å­˜
  - ç®¡ç†ä»£ç†é…ç½®

### 5. WebæœåŠ¡å±‚ (Web Service Layer)
- **Webç•Œé¢**: åŸºäºGradioçš„äº¤äº’ç•Œé¢
- **A2AæœåŠ¡**: Agent-to-Agentæ ‡å‡†æ¥å£

## ğŸ”„ å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[è¯·æ±‚å¤„ç†å±‚]
    B --> C[å·¥ä½œæµå±‚]
    C --> D[Agentå±‚]
    D --> E[æ¨¡å‹å±‚]
    E --> D
    D --> C
    C --> F[ç»“æœè¾“å‡º]
```

## ğŸ’¡ å…³é”®è®¾è®¡å†³ç­–

1. **æ¨¡å—åŒ–è®¾è®¡**
   - æ¯ä¸ªAgentç‹¬ç«‹è´Ÿè´£ç‰¹å®šä»»åŠ¡
   - ä¾¿äºæ‰©å±•å’Œç»´æŠ¤
   - æ”¯æŒçµæ´»çš„ç»„ä»¶æ›¿æ¢

2. **çŠ¶æ€ç®¡ç†**
   - ä½¿ç”¨TypedDictç®¡ç†çŠ¶æ€
   - ç¡®ä¿ç±»å‹å®‰å…¨
   - æ”¯æŒçŠ¶æ€è¿½è¸ªå’Œæ¢å¤

3. **é”™è¯¯å¤„ç†**
   - å¤šå±‚çº§é”™è¯¯æ•è·
   - ä¼˜é›…çš„é™çº§ç­–ç•¥
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

4. **å¯æ‰©å±•æ€§**
   - æ”¯æŒæ·»åŠ æ–°çš„æ¨¡å‹ç±»å‹
   - å¯æ‰©å±•çš„AgentåŠŸèƒ½
   - çµæ´»çš„å·¥ä½œæµå®šåˆ¶

## ğŸ”§ é…ç½®ç®¡ç†

### ç¯å¢ƒå˜é‡
- `GOOGLE_API_KEY`: Gemini APIå¯†é’¥
- `OPENAI_API_KEY`: OpenAI APIå¯†é’¥
- `HTTPS_PROXY`: HTTPSä»£ç†è®¾ç½®
- `HTTP_PROXY`: HTTPä»£ç†è®¾ç½®

### ç¼“å­˜ç­–ç•¥
- æ¨¡å‹å®ä¾‹ç¼“å­˜
- å·¥ä½œæµçŠ¶æ€ç¼“å­˜
- ç»“æœç¼“å­˜

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

1. **å“åº”æ—¶é—´ä¼˜åŒ–**
   - æ¨¡å‹å®ä¾‹ç¼“å­˜
   - å¹¶è¡Œå¤„ç†
   - æµå¼å“åº”

2. **èµ„æºä½¿ç”¨**
   - å†…å­˜ç®¡ç†
   - APIè°ƒç”¨ä¼˜åŒ–
   - ç¼“å­˜æ¸…ç†

3. **å¯é æ€§**
   - é”™è¯¯é‡è¯•æœºåˆ¶
   - è¶…æ—¶å¤„ç†
   - çŠ¶æ€æ¢å¤

## ğŸ”’ å®‰å…¨æ€§

1. **APIå¯†é’¥ç®¡ç†**
   - ç¯å¢ƒå˜é‡é…ç½®
   - å¯†é’¥éªŒè¯
   - è®¿é—®æ§åˆ¶

2. **è¾“å…¥éªŒè¯**
   - è¯·æ±‚æ•°æ®éªŒè¯
   - ç±»å‹æ£€æŸ¥
   - å®‰å…¨è¿‡æ»¤

3. **é”™è¯¯å¤„ç†**
   - å®‰å…¨çš„é”™è¯¯æ¶ˆæ¯
   - æ—¥å¿—è„±æ•
   - å¼‚å¸¸éš”ç¦»

## ğŸ”„ æœªæ¥æ‰©å±•

1. **æ–°åŠŸèƒ½**
   - æ›´å¤šæ¨¡å‹æ”¯æŒ
   - é«˜çº§ä¼˜åŒ–ç­–ç•¥
   - è‡ªå®šä¹‰è¯„ä¼°æŒ‡æ ‡

2. **æ€§èƒ½ä¼˜åŒ–**
   - åˆ†å¸ƒå¼å¤„ç†
   - æ›´æ™ºèƒ½çš„ç¼“å­˜
   - æ‰¹å¤„ç†æ”¯æŒ

3. **é›†æˆå¢å¼º**
   - æ›´å¤šAPIé›†æˆ
   - æ’ä»¶ç³»ç»Ÿ
   - ç›‘æ§å’Œåˆ†æ

## ğŸ“ æ–‡ä»¶ç»“æ„

```
prompt_agent/
â”œâ”€â”€ main.py                     # ä¸»æœåŠ¡å…¥å£
â”œâ”€â”€ prompt_optimizer.py         # å¤šAgentå·¥ä½œæµå®ç°
â”œâ”€â”€ prompt_optimizer_executor.py # A2Aé›†æˆå±‚
â”œâ”€â”€ setup_and_run.py           # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ demo.py                     # æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ test_prompt_optimizer.py    # æµ‹è¯•å®¢æˆ·ç«¯
â”œâ”€â”€ config_example.env          # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ requirements.txt            # ä¾èµ–ç®¡ç†
â”œâ”€â”€ README.md                   # ä½¿ç”¨è¯´æ˜
â””â”€â”€ ARCHITECTURE.md             # æ¶æ„æ–‡æ¡£
```

## ğŸš€ éƒ¨ç½²å’Œæ‰©å±•

### æ°´å¹³æ‰©å±•
- æ¯ä¸ªAgentå¯ç‹¬ç«‹æ‰©å±•
- æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²
- çŠ¶æ€æŒä¹…åŒ–æ”¯æŒ

### æ€§èƒ½ä¼˜åŒ–
- å¼‚æ­¥å¤„ç†æå‡ååé‡
- ç¼“å­˜æœºåˆ¶å‡å°‘é‡å¤è®¡ç®—
- å¹¶è¡Œæ‰§è¡ŒCompatibleçš„æ“ä½œ

### ç›‘æ§å’Œè§‚æµ‹
- LangSmithé›†æˆæ”¯æŒ
- è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†

## ğŸ”„ å·¥ä½œæµä¼˜åŒ–æ€è·¯

æ‚¨æè¿°çš„ä¼˜åŒ–æµç¨‹å®Œç¾åœ°æ˜ å°„åˆ°äº†æˆ‘ä»¬çš„å¤šAgentæ¶æ„ï¼š

1. **"Generate a detailed prompt engineering guide"** â†’ `PromptGeneratorAgent.generate_prompt_engineering_guide()`
2. **"Paste in 5 examples"** â†’ é€šè¿‡è¾“å…¥å‚æ•°æä¾›
3. **"Generate a prompt that could have generated the examples' outputs"** â†’ `PromptGeneratorAgent.generate_prompt_from_examples()`
4. **"Generate a detailed prompt evaluation guide"** â†’ `PromptEvaluatorAgent.generate_evaluation_guide()`
5. **"Evaluate the prompt"** â†’ `PromptEvaluatorAgent.evaluate_prompt()`
6. **"Generate 3 improved alternative prompts"** â†’ `PromptImproverAgent.generate_improved_prompts()`
7. **"Pick the best one, and edit as necessary"** â†’ `finalize_node()` + ç”¨æˆ·é€‰æ‹©

è¿™ç§è®¾è®¡å……åˆ†åˆ©ç”¨äº†"LLM's own weights influence how the prompt is generated and evaluated"çš„ä¼˜åŠ¿ï¼Œæ¯ä¸ªAgentéƒ½ä½¿ç”¨åŒä¸€æ¨¡å‹å®¶æ—ï¼Œç¡®ä¿ä¸€è‡´æ€§å’Œæœ€ä½³æ•ˆæœã€‚ 